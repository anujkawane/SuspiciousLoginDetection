# Suspicious Login Detection Pipeline

The main motivation behind this project is to process the logs generated when users login into a website and detect any fraudulent activity if there exists. Consider a website having users with a paid subscription to their service with more than 5 million accounts daily logging into their website. It is important to understand the userâ€™s behavior as several organizations do not want user to share his login details with another person and thereby save a lot of money. With huge amounts of logs generating daily, we need a system fast enough to analyze these logs and take action likewise. Our system aims to process these logs and decide whether it was a suspicious log in the attempt and detect fraud in real time as the logs keep on generating.
Users committing this fraud can be flagged or issued a warning, in our case we are generating alerts for the same.


### Technologies
1. Apache Kafka
2. Apache Spark
3. Python 3.9

### Prerequisites

Required packages are included in [requirements.txt](https://github.com/anujkawane/SuspiciousLoginDetection/blob/main/requirements.txt) file

1. confluent_kafka==1.8.2
2. pyspark==3.2.1
3. pandas==1.4.2
4. PyArrow==8.0.0


# Setup and run

#### For setting up kafka download the file from below url

```bash
https://drive.google.com/file/d/1iVnK2hKXyOK20IumYqTWZPbjnbrM05-X/view?usp=sharing
```


## Requirements ðŸ”§
* Python 3.9
* Spark 3.2.1

## Running The Application ðŸ”Œ


### Kafka Setup
       
* Download the Kafka setup from below link
```bash
https://drive.google.com/file/d/1iVnK2hKXyOK20IumYqTWZPbjnbrM05-X/view?usp=sharing
```
        
* Run the below commands in the kafka directory above.

```bash
tar -xzf kafka_2.12-3.1.1.tgz
cd kafka_2.12-3.1.1
bin/zookeeper-server-start.sh config/zookeeper.properties
```
        
* Change your directory to kafka_2.12-3.1.1 and run below command
```bash
bin/kafka-server-start.sh config/server.properties
```
        
        
* To create topics needed for this project using below command (new terminal)

```bash
 kafka-topics --create --partitions 1 --replication-factor 1 --topic server-logs --bootstrap-server localhost:9092
 kafka-topics --create --partitions 1 --replication-factor 1 --topic alerts --bootstrap-server localhost:9092
```
   
        
 ### Clone project
    
    
 * Download the project or clone project using below command 

```bash
git clone https://github.com/anujkawane/SuspiciousLoginDetection.git
```
       
       
* Download data file from bewlo link and paste it to the _*SuspiciousLoginDetection/DataFiles/*_ folder (Github doesnt allow larger files)

```bash
https://drive.google.com/file/d/123Qv6h1KweiAN634NBOnDxUdfuTyWDJy/view?usp=sharing
https://drive.google.com/file/d/1ngqy0G4jsVXiAFrZJOOGI4P3wJ0Gdotq/view?usp=sharing
```
        
     
### Starting Pipeline

* Create new execution environment (if needed) 

```bash
cd SuspiciousLoginDetection (if downloaded from github: cd SuspiciousLoginDetection-main)
pip install -r requirements.txt 
```

* Go inside the _*/SuspiciousLoginDetection*_ and run _*ProcessAlerts.py*_ using below commands:
```bash
cd SuspiciousLoginDetection
 
python3 ProcessAlerts.py
```

* Also run run _*SuspiciousLoginDetection.py*_ in the same folder using below commands:
```bash
python3 SuspiciousLoginDetection.py
```

* Go inside the _*/DataGeneration*_ and run _*ServerLogGenerator.py*_ using below commands:
```bash
cd DataGeneration
 
python3 ServerLogGenerator.py
```

#### Data

The data will be generated by a data generation script at `SuspiciousLoginDetection/DataGeneration/ServerLogGenerator.py`.



